(()=>{"use strict";const e=document.querySelector('.dark-mode input[type="checkbox"]'),t=localStorage.getItem("theme");t&&(document.documentElement.setAttribute("data-theme",t),"dark"===t&&(e.checked=!0));const n=document.querySelector.bind(document);function r(e){let t=n(e);return parseFloat(t.value.replace(",","."))}function i(e){var t=document.querySelector(e.form);t&&e.rules.forEach((function(n){let r=t.querySelector(n.selector);r&&(r.onblur=function(){i.validate(r,n,e)},r.oninput=function(){i.reset(e,r),r.value=r.value.replace(/[a-z]|[A-Z]/g,"")})}))}function o(){n(".results-box").classList.remove("active"),n(".overlay").classList.remove("active"),n("body").classList.remove("not-overflow")}function c(e){let t=n(e).parentElement;t.classList.contains("invalid")&&(t.classList.remove("invalid"),t.querySelector(".form-message").innerHTML="")}i.isRequired=function(e){return{selector:e,test(e){let t=e.match(/^(1[0]|[0-9])(\.\d+)?$/g)&&+e<=10;return e.trim()?t?void 0:"Điểm số nằm trong khoảng [0-10] thôi nha.":"Bạn chưa nhập điểm nè."}}},i.validate=function(e,t,n){let r=e.parentElement.querySelector(n.errorSelector),o=t.test(e.value);if(o)return r.innerText=o,void e.parentElement.classList.add("invalid");i.reset(n,e)},i.reset=function(e=e,t=t){t.parentElement.querySelector(e.errorSelector).innerText="",t.parentElement.classList.remove("invalid")};const a=document.getElementsByTagName("option"),s=n("#type_school");let l;e.addEventListener("change",(function(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))})),s.onchange=function(){let e=[n("#english"),n("#combine_tn"),n("#combine_xh")],t="1"===s.value;!function(){const e=document.querySelectorAll(".input__score input"),t=document.querySelectorAll('select[name="extra_score"]');e.forEach((e=>e.value="")),t.forEach((e=>e.selectedIndex=0))}(),t?(n("#free-subject").parentElement.style.display="none",e.forEach((e=>{e.parentElement.style.display="flex"}))):(n("#free-subject").parentElement.style.display="flex",e.forEach((e=>{e.parentElement.style.display="none"})))},n(".btn__score").onclick=function(){let e=r("#math"),t=r("#literature"),i=r("#english"),o=r(l?"#combine_tn":"#combine_xh"),c=r("#average_year"),a=[e,t,i,o,r("#encor_score"),r("#prior_score"),c];var u;u=function(e,...t){let[n,i,o,c,...a]=t,[s,l,u]=a,m=!0;if([n,i,o,c,r("#free-subject")].forEach((e=>{!isNaN(e)&&e<=1&&(m=!1)})),!m)return"Chúc bạn may mắn lần sau :(";const d=e?function(e,t,n,r,i,o,c){return((e+t+n+r+i)/4*7+3*o)/10+c}(n,i,o,c,s,u,l):function(e,t,n,r,i,o){return((4*(e+t+n)+3*r)/12*7+3*i)/10+o}(n,i,r("#free-subject"),s,u,l),h=d>=5?"Bạn sẽ đậu tốt nghiệp!! Cố lên. Điểm TN:":"Bạn sẽ rớt tốt nghiệp! Cẩn thận. Điểm TN:";return isNaN(d)?"Có gì đó sai sai thiếu thiếu rồi nha.":`${h} ${d.toFixed(2)}`}("1"===s.value,...a),n(".results-box").classList.add("active"),n(".overlay").classList.add("active"),n("body").classList.add("not-overflow"),n("#results").innerHTML=u},n("#combine_tn").addEventListener("input",(function(){n("#combine_tn").value?(n("#combine_xh").setAttribute("disabled",""),n("#combine_xh").parentElement.classList.add("op-3"),c("#combine_xh"),l=!0):(n("#combine_xh").removeAttribute("disabled"),n("#combine_xh").parentElement.classList.remove("op-3"),l=void 0)})),n("#combine_xh").addEventListener("input",(function(){n("#combine_xh").value?(n("#combine_tn").setAttribute("disabled",""),n("#combine_tn").parentElement.classList.add("op-3"),c("#combine_tn"),l=!1):(n("#combine_tn").removeAttribute("disabled"),n("#combine_tn").parentElement.classList.remove("op-3"),l=void 0)})),n("#close").onclick=function(){o()},n(".overlay").onclick=function(){o()},Array.from(a).forEach((e=>{""===e.innerHTML&&(e.innerHTML=e.value)})),i({form:"#form",errorSelector:".form-message",rules:[i.isRequired("#math"),i.isRequired("#literature"),i.isRequired("#free-subject"),i.isRequired("#english"),i.isRequired("#combine_tn"),i.isRequired("#combine_xh"),i.isRequired("#average_year")]})})();